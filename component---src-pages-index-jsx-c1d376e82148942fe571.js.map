{"version":3,"file":"component---src-pages-index-jsx-c1d376e82148942fe571.js","mappings":"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","sources":["webpack://jstro.io/./src/components/PieceEmbed.jsx","webpack://jstro.io/./src/hooks/Observer.js","webpack://jstro.io/./src/hooks/useDelayCancel.js","webpack://jstro.io/./src/components/Pieces.jsx","webpack://jstro.io/./src/pages/index.jsx"],"sourcesContent":["import { Box, Card } from \"@mui/material\"\r\nimport React, { forwardRef, useEffect } from \"react\"\r\nimport { useIsVisible } from \"../hooks/Observer\"\r\n\r\nimport \"../styles/Embed.scss\"\r\n\r\nconst PieceEmbed = forwardRef(({ piece }, ref) => {\r\n  const isVisible = useIsVisible(ref)\r\n  const id = `piece-${piece}`\r\n  return (\r\n    <Box className=\"Piece\">\r\n      <Card className=\"EmbedCard\" ref={ref} id={id}>\r\n        {isVisible && (\r\n          <iframe\r\n            title=\"p5.js Sketch\"\r\n            className=\"Embed\"\r\n            src={`/sketches/${piece}`}\r\n          ></iframe>\r\n        )}\r\n      </Card>\r\n    </Box>\r\n  )\r\n})\r\n\r\nexport default PieceEmbed\r\n","// Credit: https://dev.to/jmalvarez/check-if-an-element-is-visible-with-react-hooks-27h8\r\n\r\nimport { useEffect, useState } from \"react\"\r\n\r\nexport function useIsVisible(ref) {\r\n  const [isIntersecting, setIntersecting] = useState(false)\r\n\r\n  useEffect(() => {\r\n    const observer = new IntersectionObserver(\r\n      ([entry]) => setIntersecting(entry.isIntersecting),\r\n      {\r\n        rootMargin: \"-1px\",\r\n      }\r\n    )\r\n\r\n    observer.observe(ref.current)\r\n  }, [ref])\r\n\r\n  return isIntersecting\r\n}\r\n","import { useState } from \"react\"\r\n\r\nexport const useDelayCancel = (delay = 100) => {\r\n  const [timer, setTimer] = useState(null)\r\n  const delayCancel = (callback) => {\r\n    if (timer) clearTimeout(timer)\r\n    setTimer(\r\n      setTimeout(() => {\r\n        setTimer(null)\r\n        callback()\r\n      }, delay)\r\n    )\r\n  }\r\n  return delayCancel\r\n}\r\n","import { Paper, useTheme } from \"@mui/material\"\r\nimport React, { createRef } from \"react\"\r\nimport { useState, useEffect } from \"react\"\r\nimport PieceEmbed from \"./PieceEmbed\"\r\n\r\nimport \"../styles/Pieces.scss\"\r\nimport { useDelayCancel } from \"../hooks/useDelayCancel\"\r\n\r\nconst Pieces = ({ location }) => {\r\n  const [ids, setIds] = useState([])\r\n  const [refs, setRefs] = useState([])\r\n  useEffect(() => {\r\n    const effect = async () => {\r\n      const p5Ids = await import(\"/static/p5ids.json\")\r\n      setIds(Array.from(p5Ids))\r\n      setRefs(Array.from(p5Ids).map(() => createRef()))\r\n    }\r\n    effect()\r\n  }, [])\r\n\r\n  const [visibleId, setVisibleId] = useState(null)\r\n  const observe = () => {\r\n    const observer = new IntersectionObserver(\r\n      (entries) => {\r\n        const entry = entries.find((entry) => entry.isIntersecting)\r\n        if (!entry) return\r\n        setVisibleId(entry.target.id.substring(\"piece-\".length))\r\n      },\r\n      {\r\n        rootMargin: \"-1px\",\r\n      }\r\n    )\r\n    refs.forEach((ref) => {\r\n      if (!ref.current) return\r\n      observer.observe(ref.current)\r\n    })\r\n  }\r\n  const scrollDelayCancel = useDelayCancel(100)\r\n  const onScroll = () => {\r\n    scrollDelayCancel(() => observe())\r\n  }\r\n  const hashDelayCancel = useDelayCancel(200)\r\n  useEffect(() => {\r\n    hashDelayCancel(() => {\r\n      if (!visibleId) return\r\n      window.location.hash = `#${visibleId}`\r\n    })\r\n  }, [visibleId]) // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const scrollToPiece = (piece) =>\r\n    document.querySelector(`#piece-${piece}`)?.scrollIntoView()\r\n  const urlPiece = location.hash.substring(1)\r\n  const urlPieceDelayCancel = useDelayCancel(400)\r\n  useEffect(() => {\r\n    urlPieceDelayCancel(() => {\r\n      if (urlPiece && urlPiece !== visibleId) scrollToPiece(urlPiece)\r\n    })\r\n  }, [urlPiece, visibleId]) // eslint-disable-line react-hooks/exhaustive-deps\r\n  useEffect(() => {\r\n    if (urlPiece) scrollToPiece(urlPiece)\r\n    else observe()\r\n  }, []) // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const theme = useTheme()\r\n  return (\r\n    <Paper\r\n      className=\"Pieces\"\r\n      id=\"pieces\"\r\n      style={{ background: theme.vars.palette.secondary.main }}\r\n      elevation={24}\r\n      onScroll={onScroll}\r\n    >\r\n      {ids.map((id, i) => (\r\n        <PieceEmbed piece={id} ref={refs[i]} key={id} />\r\n      ))}\r\n    </Paper>\r\n  )\r\n}\r\n\r\nexport default Pieces\r\n","import React from \"react\"\r\nimport PageWrapper from \"../components/PageWrapper\"\r\nimport Pieces from \"../components/Pieces\"\r\n\r\nimport \"../styles/index.scss\"\r\n\r\nconst IndexPage = ({ location }) => {\r\n  return (\r\n    <PageWrapper>\r\n      <Pieces location={location} />\r\n    </PageWrapper>\r\n  )\r\n}\r\n\r\nexport default IndexPage\r\n"],"names":["forwardRef","_ref","ref","piece","isVisible","isIntersecting","setIntersecting","useState","useEffect","IntersectionObserver","entry","rootMargin","observe","current","useIsVisible","id","React","Box","className","Card","title","src","useDelayCancel","delay","timer","setTimer","callback","clearTimeout","setTimeout","location","ids","setIds","refs","setRefs","async","p5Ids","Array","from","map","createRef","effect","visibleId","setVisibleId","observer","entries","find","target","substring","forEach","scrollDelayCancel","hashDelayCancel","window","hash","scrollToPiece","_document$querySelect","document","querySelector","scrollIntoView","urlPiece","urlPieceDelayCancel","theme","useTheme","Paper","style","background","vars","palette","secondary","main","elevation","onScroll","i","PieceEmbed","key","PageWrapper","Pieces"],"sourceRoot":""}