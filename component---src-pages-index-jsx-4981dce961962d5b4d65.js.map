{"version":3,"file":"component---src-pages-index-jsx-4981dce961962d5b4d65.js","mappings":"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","sources":["webpack://jstro.io/./src/components/PieceEmbed.jsx","webpack://jstro.io/./src/hooks/Observer.js","webpack://jstro.io/./src/hooks/useDelayCancel.js","webpack://jstro.io/./src/components/Pieces.jsx","webpack://jstro.io/./src/pages/index.jsx"],"sourcesContent":["import { Box, Card } from \"@mui/material\"\nimport React, { forwardRef } from \"react\"\nimport { useIsVisible } from \"../hooks/Observer\"\n\nimport \"../styles/Embed.scss\"\n\nconst PieceEmbed = forwardRef(({ piece }, ref) => {\n  const isVisible = useIsVisible(ref)\n  const id = `piece-${piece}`\n  return (\n    <Box className=\"Piece\">\n      <Card className=\"EmbedCard\" ref={ref} id={id}>\n        {isVisible && (\n          <iframe\n            title=\"p5.js Sketch\"\n            className=\"Embed\"\n            src={`/sketches/${piece}`}\n          ></iframe>\n        )}\n      </Card>\n    </Box>\n  )\n})\n\nexport default PieceEmbed\n","// Credit: https://dev.to/jmalvarez/check-if-an-element-is-visible-with-react-hooks-27h8\n\nimport { useEffect, useState } from \"react\"\n\nexport function useIsVisible(ref) {\n  const [isIntersecting, setIntersecting] = useState(false)\n\n  useEffect(() => {\n    const observer = new IntersectionObserver(\n      ([entry]) => setIntersecting(entry.isIntersecting),\n      {\n        rootMargin: \"-1px\",\n      }\n    )\n\n    observer.observe(ref.current)\n  }, [ref])\n\n  return isIntersecting\n}\n","import { useState } from \"react\"\n\nexport const useDelayCancel = (delay = 100) => {\n  let [timer, setTimerState] = useState(null)\n  const setTimer = (val) => {\n    timer = val;\n    setTimerState(timer)\n  }\n  const delayCancel = (callback) => {\n    if (timer) clearTimeout(timer)\n    setTimer(\n      setTimeout(() => {\n        setTimer(null)\n        callback()\n      }, delay)\n    )\n  }\n  return delayCancel\n}\n","import { Paper, useTheme } from \"@mui/material\"\nimport React, { createRef } from \"react\"\nimport { useState, useEffect } from \"react\"\nimport PieceEmbed from \"./PieceEmbed\"\n\nimport \"../styles/Pieces.scss\"\nimport { useDelayCancel } from \"../hooks/useDelayCancel\"\n\nconst Pieces = ({ location }) => {\n  const [ids, setIds] = useState([])\n  const [refs, setRefs] = useState([])\n  useEffect(() => {\n    const effect = async () => {\n      const p5Ids = await import(\"/static/p5ids.json\")\n      setIds(Array.from(p5Ids))\n      setRefs(Array.from(p5Ids).map(() => createRef()))\n    }\n    effect()\n  }, [])\n\n  const [visibleId, setVisibleId] = useState(null)\n  const observe = () => {\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const entry = entries.find((entry) => entry.isIntersecting)\n        if (!entry) return\n        setVisibleId(entry.target.id.substring(\"piece-\".length))\n      },\n      {\n        rootMargin: \"-10px\",\n      }\n    )\n    refs\n      .filter((ref) => ref.current)\n      .forEach((ref) => {\n        observer.observe(ref.current)\n      })\n  }\n  const scrollDelayCancel = useDelayCancel(10)\n  const onScroll = () => {\n    scrollDelayCancel(() => observe())\n  }\n  const hashDelayCancel = useDelayCancel(100)\n\n  // Track URL hash and what we have set it to programtically\n  const urlPiece = location.hash.substring(1)\n  const [targetUrlPiece, setTargetUrlPiece] = useState(null)\n  useEffect(() => {\n    hashDelayCancel(() => {\n      if (!visibleId) return\n      const url = new URL(location.href)\n      url.hash = `#${visibleId}`\n      window.location.replace(url)\n      setTargetUrlPiece(visibleId)\n    })\n  }, [visibleId]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  const scrollToPiece = (piece) =>\n    document.querySelector(`#piece-${piece}`)?.scrollIntoView()\n\n  const urlPieceDelayCancel = useDelayCancel(200)\n  useEffect(() => {\n    urlPieceDelayCancel(() => {\n      if (urlPiece === targetUrlPiece) return\n      if (!urlPiece) scrollToPiece(ids[0])\n      if (urlPiece && urlPiece !== visibleId) scrollToPiece(urlPiece)\n    })\n  }, [urlPiece, visibleId]) // eslint-disable-line react-hooks/exhaustive-deps\n  useEffect(() => {\n    if (urlPiece) scrollToPiece(urlPiece)\n    else observe()\n  }, [refs]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  const theme = useTheme()\n  return (\n    <Paper\n      className=\"Pieces\"\n      id=\"pieces\"\n      style={{ background: theme.vars.palette.secondary.main }}\n      elevation={24}\n      onScroll={onScroll}\n    >\n      {ids.map((id, i) => (\n        <PieceEmbed piece={id} ref={refs[i]} key={id} />\n      ))}\n    </Paper>\n  )\n}\n\nexport default Pieces\n","import React from \"react\"\nimport PageWrapper from \"../components/PageWrapper\"\nimport Pieces from \"../components/Pieces\"\n\nimport \"../styles/index.scss\"\n\nconst IndexPage = ({ location }) => {\n  return (\n    <PageWrapper>\n      <Pieces location={location} />\n    </PageWrapper>\n  )\n}\n\nexport default IndexPage\n"],"names":["forwardRef","_ref","ref","piece","isVisible","isIntersecting","setIntersecting","useState","useEffect","IntersectionObserver","entry","rootMargin","observe","current","useIsVisible","id","React","Box","className","Card","title","src","useDelayCancel","delay","timer","setTimerState","setTimer","val","callback","clearTimeout","setTimeout","location","ids","setIds","refs","setRefs","async","p5Ids","Array","from","map","createRef","effect","visibleId","setVisibleId","observer","entries","find","target","substring","filter","forEach","scrollDelayCancel","hashDelayCancel","urlPiece","hash","targetUrlPiece","setTargetUrlPiece","url","URL","href","window","replace","scrollToPiece","_document$querySelect","document","querySelector","scrollIntoView","urlPieceDelayCancel","theme","useTheme","Paper","style","background","vars","palette","secondary","main","elevation","onScroll","i","PieceEmbed","key","PageWrapper","Pieces"],"sourceRoot":""}